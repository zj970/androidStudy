# 第11章 Android 特色开发——基于位置的服务

&emsp;&emsp;现在你已经学会了非常多的Android 技能，并且通过这些技能你完全可以编写出相当不错的应用程序了。不过本章中，我们将要学习一些全新的Android技术，这些技术有别于传统的传统的PC或Web领域的应用技术，是只有在移动设备上才能实现的。  
&emsp;&emsp;说到只有在移动设备上才能实现的技术，很容易就让人联想到基于位置的服务(Location Base Service)。由于移动设备相比于电脑可以随身携带，我们通过地理定位的技术就可以随时得到自己所在的位置。从而围绕这一点开发出很多有意思的应用。本章中我们就将针对这一点进行讨论，学习一下基于位置的服务究竟是如何实现的。  

### 11.1 基于位置的服务简介

&emsp;&emsp;基于位置的服务简称LBS，随着移动互联网的兴起，这个技术在最近的几年里十分火爆。其实它本身并不是什么时髦的技术，主要的工作原理就是利用无线电通讯或GPS等定位方式来确定出移动设备所在的位置，而这种定位技术早在很多年前就已经出现了。  
&emsp;&emsp;那为什么LBS结束直到最近几年才开始流行呢？这主要是因为，在过去移动设备的功能极其有限，即使定位到了设备所在的位置，也就仅仅只是定位到了而已，我们并不能在位置的基础上进行一些其他的操作。而现在就太大不同了，有了Android系统作为载体，我们可以利用定位出的位置进行絮叨丰富多彩的操作。比如说天气预报程序可以根据用户所在的位置自动选选择城市，发微博的时候我们可以向朋友们晒一下自己在哪里，不认识路的时候随时打开滴入就可以查询路线等等。  
&emsp;&emsp;介绍了这么多，首先要清楚，基于位置的服务所未然的核心就是要先确定用户所在的位置。通常有两种技术方式可以实现：一种是通过GPS定位，一种是通过网络定位。GPS定位的工作原理是基于手机内置的GPS硬件直接和卫星交互来获取当前的经纬度信息，这种定位方式精确度非常高，但缺点是只能在室外使用，室内基本无法接收到卫星的信号。网络定位的工作原理是根据手机当前网络附近的三个基站进行测速，以此计算出手机和每个基站之间的距离，再通过三角定位出一个大概位置，这定位方式精确度一般，但优点是在室内室外都可以使用。  
&emsp;&emsp;Android对这两种定位方式都提供了相应的API支持，但是由于一些特殊原因，Google的网络服务在中国不可访问，从而导致网络定位方式的API失效。而GPS定位虽然不需要网络，但是必须在室外才可以使用，因此你在室内开发的时候很有可能会遇到不管使用哪种定位方式都无法成功定位的情况。  
&emsp;&emsp;基于以上原因，不在本书讲解Android原生定位API的用法，而是使用国内第三方公司的SDK。目前国内在这一领域做得比较好的一个是百度，一个是搞得，本章我们就来学习一下百度在LBS方面提供的丰富多彩的功能。  

### 11.2 申请 API Key

&emsp;&emsp;要向在自己的应用程序里使用百度的LBS功能，首先必须申请一个API Key。你得拥有一个百度账号才能进行申请，有了百度账号之后，我们就可以申请成为一名百度开发者，登录你的百度账号，并打开http://developer.baidu.com/user/reg这个网站，在这里填写一些注册信息。

![img.png](img.png)

&emsp;&emsp;填写认证完成后，接着访问http://lbsyum.baidu.com/apiconsole/key这个地址

![img_1.png](img_1.png)

&emsp;&emsp;然后创建应用申请API Key，应用名称随便填，应用类型选择Android SDK ，启用服务保持默认即可。

![img_2.png](img_2.png)

&emsp;&emsp;那么，这个发布版SHA1和开发版SHA1又是什么呢？这是我们申请API Key所必须填写的一个字段，它指的是打包程序时所用的签名文件的SHA1指纹，可以通过Android Studio查看到。代开Android Studio中的任意一个项目，点击右侧工具栏中的Gradle->项目名->:app->Tasks->Android

![img_3.png](img_3.png)

&emsp;&emsp;这里展示了一个Android Studio 项目中所有内置的Gradle Tasks，其中signingReport这个Task就可以用来查看签名文件信息。双击signingReport